language: sh

os:
  - windows
  
before_install:
  - choco install pandoc
  - choco install python2
  - PATH=$PATH:C:/Python27/Scripts/
  - C:/Python27/Scripts/pip.exe install sphinx
  #- C:/Python27/Scripts/pip.exe install themata
  
before_script:
  #there is no need to configure build toolchain since the platform on travis CI  
  #is windows and will come prebuilt with powershell, .NET platform, VBS and Batch

script:
  - mkdir dist/
  - cd dist/
  - git clone https://github.com/Thecarisma/themata.git
  - cd themata/
  - C:/Python27/Scripts/pip.exe install .
  - cd ../../
  - powershell -Command Set-ExecutionPolicy Bypass
  - powershell -Command $(pwd)/Cronux.bat docronux
  - cd dist/
  - git clone https://github.com/Thecarisma/Cronux.wiki.git
  - cd Cronux.wiki/
  - cp -r ../wiki/* ./
  - git config --local user.email "azeezadewale98@gmail.com"
  - git config --local user.name "Travis CI"
  - git add .; git commit -m "Travis build=${TRAVIS_BUILD_NUMBER}. Update Wiki from Travis CI"
  #- git push https://Thecarisma:${GITHUB_TOKEN}@github.com/Thecarisma/Cronux.wiki.git HEAD:master;
  - cd ../../
  - cd dist/gh-pages/
  - C:/Python27/Scripts/sphinx-build.exe -b html -d build/doctrees  ./ build/html
  - cd ../../
  - ls
  - rm -R commands/
  - rm -R docs/
  - rm *.*
  - ls
  - cp -r dist/gh-pages/* ./
  - ls
  
# deploy:
  # provider: pages
  # skip_cleanup: true
  # github_token: $GITHUB_TOKEN  # Set in the settings page of your repository, as a secure variable
  # keep_history: true
  # local_dir: /C/Users/travis/build/Thecarisma/Cronux/dist/gh-pages/build/html/
  # on:
     # branch: master
